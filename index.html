<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>WorldView Live - Cesium</title>
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.117/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.117/Build/Cesium/Widgets/widgets.css" rel="stylesheet" />
  <style>
    html, body, #cesiumContainer {
      width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden;
      font-family: Arial, sans-serif;
    }

    #camera-info {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 15px;
      border-radius: 8px;
      z-index: 10;
      display: none;
      max-width: 320px;
    }

    #camera-info img {
      width: 100%;
      border-radius: 5px;
    }

    #camera-info button {
      margin-top: 10px;
      padding: 8px 12px;
      background-color: #00c8ff;
      border: none;
      border-radius: 5px;
      color: #121212;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="cesiumContainer"></div>

  <div id="camera-info">
    <h3 id="camera-title">Nome da Câmera</h3>
    <p id="camera-location">Local: --</p>
    <img id="camera-video" src="" alt="Stream ao vivo" />
    <button onclick="document.getElementById('camera-info').style.display='none'">Fechar</button>
  </div>

  <script>
    // Inicializa o globo
    const viewer = new Cesium.Viewer('cesiumContainer', {
      terrainProvider: Cesium.createWorldTerrain(),
      baseLayerPicker: false
    });

    // Exemplo de ponto de câmera pública
    const cameraData = {
      nome: 'Highway Cam - Cheyenne',
      cidade: 'Wyoming, EUA',
      lat: 41.139981,
      lon: -104.820246,
      stream: 'https://images.drivebc.ca/bchighwaycam/pub/cameras/250.jpg'
    };

    // Cria o ponto vermelho no globo
    const entity = viewer.entities.add({
      name: cameraData.nome,
      position: Cesium.Cartesian3.fromDegrees(cameraData.lon, cameraData.lat),
      point: {
        pixelSize: 12,
        color: Cesium.Color.RED,
        outlineColor: Cesium.Color.WHITE,
        outlineWidth: 2
      },
      description: `
        <strong>${cameraData.nome}</strong><br/>
        Local: ${cameraData.cidade}<br/>
        <img src="${cameraData.stream}?_=${Date.now()}" width="100%"/>
      `
    });

    // Move a câmera até o ponto no início
    viewer.flyTo(entity);

    // Evento de clique
    const handler = new Cesium.ScreenSpaceEventHandler(viewer.scene.canvas);
    handler.setInputAction(function (movement) {
      const pickedObject = viewer.scene.pick(movement.position);
      if (Cesium.defined(pickedObject) && pickedObject.id === entity) {
        document.getElementById('camera-title').textContent = cameraData.nome;
        document.getElementById('camera-location').textContent = `Local: ${cameraData.cidade}`;
        document.getElementById('camera-video').src = `${cameraData.stream}?_=${Date.now()}`;
        document.getElementById('camera-info').style.display = 'block';
      }
    }, Cesium.ScreenSpaceEventType.LEFT_CLICK);
  </script>
</body>
</html>
